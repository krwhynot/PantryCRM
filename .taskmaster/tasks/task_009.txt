# Task ID: 9
# Title: Create Sales Pipeline Foundation
# Status: pending
# Dependencies: 6
# Priority: medium
# Description: Implement the five-stage sales pipeline structure and opportunity tracking system for the 11 food service principals.
# Details:
Create Opportunity model: organization_id FK, contact_id FK, principal (11 brands from Settings), stage (Lead-discovery, Contacted, Sampled/Visited, Follow-up, Close), probability percentage, estimated_value, expected_close_date, notes. Implement API endpoints: GET /api/opportunities (with filtering), POST/PUT/DELETE /api/opportunities/[id]. Create OpportunityForm with principal selection from Settings, stage progression logic, probability auto-calculation based on stage. Build pipeline stage validation - opportunities can only move forward or stay in same stage. Add opportunity history tracking for stage changes. Use Zod validation: z.object({ principal: z.string(), stage: z.enum(['Lead-discovery', 'Contacted', 'Sampled/Visited', 'Follow-up', 'Close']), probability: z.number().min(0).max(100), estimated_value: z.number().optional() }).

# Test Strategy:
Test opportunity CRUD operations, verify stage progression logic, validate probability calculations, confirm principal selection from Settings, and test opportunity history tracking.
